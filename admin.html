<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library Admin Page</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 0;
        }
        .top-bar {
            background-color: #000;
            color: #fff;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .top-bar h1 {
            margin: 0;
            font-size: 20px;
        }
        .logout-btn {
            background-color: #dc3545;
            color: #fff;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .logout-btn:hover {
            background-color: #c82333;
        }
        .container {
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }
        h3 {
            color: #ffffff;
        }
        h1, h2 {
            color: #333;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #007bff;
            color: #fff;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .actions button {
            background-color: #dc3545;
            margin-left: 5px;
        }
        .actions button:hover {
            background-color: #c82333;
        }
        .form-actions {
            margin-top: 10px;
        }
        .edit-form {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }
        .edit-form .form-actions {
            margin-top: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <h3>Zeta E-Library System</h3>
        <button class="logout-btn">Logout</button>
    </div>
    <div class="container">
        <h1>Library Admin Page</h1>
        
        <h2>Register Student Info</h2>
        <form id="studentForm">
            <div class="form-group">
                <label for="studentName">Name:</label>
                <input type="text" id="studentName" required>
            </div>
            <div class="form-group">
                <label for="studentID">ID:</label>
                <input type="text" id="studentID" required>
            </div>
            <div class="form-group">
                <label for="studentGender">Gender:</label>
                <select id="studentGender" required>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                </select>
            </div>
            <div class="form-group">
                <label for="studentPhone">Phone Number:</label>
                <input type="text" id="studentPhone" required>
            </div>
            <div class="form-group">
                <label for="borrowDate">Borrow Date:</label>
                <input type="date" id="borrowDate" required>
            </div>
            <div class="form-group">
                <label for="returnDate">Return Date:</label>
                <input type="date" id="returnDate" required>
            </div>
            <div class="form-actions">
                <button type="button" onclick="addStudent()">Add Student</button>
                <button type="button" onclick="clearStudentForm()">Clear</button>
            </div>
        </form>
        <h2>Manage Books</h2>
        <form id="bookForm">
            <div class="form-group">
                <label for="bookTitle">Title:</label>
                <input type="text" id="bookTitle" required>
            </div>
            <div class="form-group">
                <label for="bookAuthor">Author:</label>
                <input type="text" id="bookAuthor" required>
            </div>
            <div class="form-group">
                <label for="publishDate">Publish Date:</label>
                <input type="date" id="publishDate" required>
            </div>
            <div class="form-group">
                <label for="bookID">Book ID:</label>
                <input type="text" id="bookID" required>
            </div>
            <div class="form-group">
                <label for="pdfForm">PDF Form:</label>
                <input type="file" id="pdfForm" accept=".pdf">
            </div>
            <div class="form-actions">
                <button type="button" onclick="addBook()">Add Book</button>
                <button type="button" onclick="clearBookForm()">Clear</button>
            </div>
        </form>

        <h2>Student List</h2>
        <table id="studentTable">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>ID</th>
                    <th>Gender</th>
                    <th>Phone Number</th>
                    <th>Borrow Date</th>
                    <th>Return Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <!-- Student rows will be added here -->
            </tbody>
        </table>

        <div id="editStudentForm" class="edit-form">
            <h2>Edit Student</h2>
            <form id="editStudent">
                <div class="form-group">
                    <label for="editStudentName">Name:</label>
                    <input type="text" id="editStudentName" required>
                </div>
                <div class="form-group">
                    <label for="editStudentID">ID:</label>
                    <input type="text" id="editStudentID" required>
                </div>
                <div class="form-group">
                    <label for="editStudentGender">Gender:</label>
                    <select id="editStudentGender" required>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editStudentPhone">Phone Number:</label>
                    <input type="text" id="editStudentPhone" required>
                </div>
                <div class="form-group">
                    <label for="editBorrowDate">Borrow Date:</label>
                    <input type="date" id="editBorrowDate" required>
                </div>
                <div class="form-group">
                    <label for="editReturnDate">Return Date:</label>
                    <input type="date" id="editReturnDate" required>
                </div>
                <div class="form-actions">
                    <button type="button" onclick="updateStudent()">Update Student</button>
                    <button type="button" onclick="cancelEditStudent()">Cancel</button>
                </div>
            </form>
        </div>
        <h2>Book List</h2>
        <table id="bookTable">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Author</th>
                    <th>Publish Date</th>
                    <th>Book ID</th>
                    <th>PDF Form</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <!-- Book rows will be added here -->
            </tbody>
        </table>

        <div id="editBookForm" class="edit-form">
            <h2>Edit Book</h2>
            <form id="editBook">
                <div class="form-group">
                    <label for="editBookTitle">Title:</label>
                    <input type="text" id="editBookTitle" required>
                </div>
                <div class="form-group">
                    <label for="editBookAuthor">Author:</label>
                    <input type="text" id="editBookAuthor" required>
                </div>
                <div class="form-group">
                    <label for="editPublishDate">Publish Date:</label>
                    <input type="date" id="editPublishDate" required>
                </div>
                <div class="form-group">
                    <label for="editBookID">Book ID:</label>
                    <input type="text" id="editBookID" required>
                </div>
                <div class="form-group">
                    <label for="editPdfForm">PDF Form:</label>
                    <input type="file" id="editPdfForm" accept=".pdf">
                </div>
                <div class="form-actions">
                    <button type="button" onclick="updateBook()">Update Book</button>
                    <button type="button" onclick="cancelEditBook()">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
    fetchStudents();
    fetchBooks();
});

function fetchStudents() {
    const students = JSON.parse(localStorage.getItem('students')) || [];
    updateStudentTable(students);
}

function fetchBooks() {
    const books = JSON.parse(localStorage.getItem('books')) || [];
    updateBookTable(books);
}

function addStudent() {
    const students = JSON.parse(localStorage.getItem('students')) || [];
    const newStudent = {
        name: document.getElementById('studentName').value,
        id: document.getElementById('studentID').value,
        gender: document.getElementById('studentGender').value,
        phone_number: document.getElementById('studentPhone').value,
        borrow_date: document.getElementById('borrowDate').value,
        return_date: document.getElementById('returnDate').value
    };
    students.push(newStudent);
    localStorage.setItem('students', JSON.stringify(students));

    document.getElementById('studentForm').reset();
    fetchStudents();
}

function updateStudentTable(students) {
    const tableBody = document.querySelector('#studentTable tbody');
    tableBody.innerHTML = '';
    students.forEach(student => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${student.name}</td>
            <td>${student.id}</td>
            <td>${student.gender}</td>
            <td>${student.phone_number}</td>
            <td>${new Date(student.borrow_date).toLocaleDateString()}</td>
            <td>${new Date(student.return_date).toLocaleDateString()}</td>
            <td><button onclick="editStudent('${student.id}')">Edit</button> <button onclick="deleteStudent('${student.id}')">Delete</button></td>
        `;
        tableBody.appendChild(row);
    });
}

function deleteStudent(id) {
    let students = JSON.parse(localStorage.getItem('students')) || [];
    students = students.filter(student => student.id !== id);
    localStorage.setItem('students', JSON.stringify(students));
    fetchStudents();
}

function editStudent(id) {
    const students = JSON.parse(localStorage.getItem('students')) || [];
    const student = students.find(s => s.id === id);
    if (student) {
        document.getElementById('editStudentName').value = student.name;
        document.getElementById('editStudentID').value = student.id;
        document.getElementById('editStudentGender').value = student.gender;
        document.getElementById('editStudentPhone').value = student.phone_number;
        document.getElementById('editBorrowDate').value = student.borrow_date;
        document.getElementById('editReturnDate').value = student.return_date;
        
        document.getElementById('editStudentForm').style.display = 'block';
        document.getElementById('editStudentForm').dataset.studentId = id; // Store the ID in the form
    }
}

function updateStudent() {
    const id = document.getElementById('editStudentForm').dataset.studentId;
    const students = JSON.parse(localStorage.getItem('students')) || [];
    
    const updatedStudent = {
        name: document.getElementById('editStudentName').value,
        id: document.getElementById('editStudentID').value,
        gender: document.getElementById('editStudentGender').value,
        phone_number: document.getElementById('editStudentPhone').value,
        borrow_date: document.getElementById('editBorrowDate').value,
        return_date: document.getElementById('editReturnDate').value
    };
    
    const index = students.findIndex(s => s.id === id);
    if (index !== -1) {
        students[index] = updatedStudent;
        localStorage.setItem('students', JSON.stringify(students));
        fetchStudents(); // Refresh the student table
        cancelEditStudent(); // Hide the edit form
    }
}

function cancelEditStudent() {
    document.getElementById('editStudentForm').style.display = 'none';
}

function clearStudentForm() {
    document.getElementById('studentForm').reset();
}
function addBook() {
    const books = JSON.parse(localStorage.getItem('books')) || [];
    const newBook = {
        title: document.getElementById('bookTitle').value,
        author: document.getElementById('bookAuthor').value,
        publish_date: document.getElementById('publishDate').value,
        book_id: document.getElementById('bookID').value,
        pdf_form: document.getElementById('pdfForm').files[0] ? URL.createObjectURL(document.getElementById('pdfForm').files[0]) : ''
    };
    books.push(newBook);
    localStorage.setItem('books', JSON.stringify(books));

    document.getElementById('bookForm').reset();
    fetchBooks();
}

function updateBookTable(books) {
    const tableBody = document.querySelector('#bookTable tbody');
    tableBody.innerHTML = '';
    books.forEach(book => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${book.title}</td>
            <td>${book.author}</td>
            <td>${new Date(book.publish_date).toLocaleDateString()}</td>
            <td>${book.book_id}</td>
            <td><a href="${book.pdf_form}" target="_blank">View PDF</a></td>
            <td><button onclick="editBook('${book.book_id}')">Edit</button> <button onclick="deleteBook('${book.book_id}')">Delete</button></td>
        `;
        tableBody.appendChild(row);
    });
}

function deleteBook(id) {
    let books = JSON.parse(localStorage.getItem('books')) || [];
    books = books.filter(book => book.book_id !== id);
    localStorage.setItem('books', JSON.stringify(books));
    fetchBooks();
}

function editBook(id) {
    const books = JSON.parse(localStorage.getItem('books')) || [];
    const book = books.find(b => b.book_id === id);
    if (book) {
        document.getElementById('editBookTitle').value = book.title;
        document.getElementById('editBookAuthor').value = book.author;
        document.getElementById('editPublishDate').value = book.publish_date;
        document.getElementById('editBookID').value = book.book_id;
        
        // Note: PDF form is not editable, so we just display the link
        document.getElementById('editPdfForm').value = ''; 
        
        document.getElementById('editBookForm').style.display = 'block';
        document.getElementById('editBookForm').dataset.bookId = id; // Store the ID in the form
    }
}

function updateBook() {
    const id = document.getElementById('editBookForm').dataset.bookId;
    const books = JSON.parse(localStorage.getItem('books')) || [];
    
    const updatedBook = {
        title: document.getElementById('editBookTitle').value,
        author: document.getElementById('editBookAuthor').value,
        publish_date: document.getElementById('editPublishDate').value,
        book_id: document.getElementById('editBookID').value,
        pdf_form: document.getElementById('editPdfForm').files[0] ? URL.createObjectURL(document.getElementById('editPdfForm').files[0]) : ''
    };
    
    const index = books.findIndex(b => b.book_id === id);
    if (index !== -1) {
        books[index] = updatedBook;
        localStorage.setItem('books', JSON.stringify(books));
        fetchBooks(); // Refresh the book table
        cancelEditBook(); // Hide the edit form
    }
}

function cancelEditBook() {
    document.getElementById('editBookForm').style.display = 'none';
}

function clearBookForm() {
    document.getElementById('bookForm').reset();
}

document.querySelector('.logout-btn').addEventListener('click', function() {
    window.location.href = 'login.html';
});

    </script>
</body>
</html>
